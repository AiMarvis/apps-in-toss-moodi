# 검수 이슈 5: 토스 로그인 시 약관 동의 화면 미표시 확인

## 분석 결과

### 1. 코드 검토 (ensureAuth.ts)

#### appLogin() 호출 방식 ✅ 정상
```typescript
// Line 12, 41
const { authorizationCode, referrer } = await appLogin();
```

**확인 사항:**
- ✅ `@apps-in-toss/web-framework`에서 `appLogin` 정상 import
- ✅ 파라미터 없이 호출 (SDK 기본 동작)
- ✅ 반환값 `authorizationCode`, `referrer` 정상 처리
- ✅ 에러 처리 구현됨 (try-catch)

#### 디버그 로깅 ✅ 충분함
```typescript
// signInWithToss() 함수에 상세 로깅 구현
logger.debug('Auth', 'appLogin() 호출');
logger.debug('Auth', 'appLogin() 성공', referrer);
```

### 2. SDK 문서 확인

**SDK 명시 사항:**
> "appLogin 함수를 호출하면 토스 로그인 창이 열리고, 앱인토스 콘솔에서 등록한 약관 동의 화면이 노출돼요"

**의미:**
- appLogin()은 약관 동의 화면을 자동으로 표시하는 책임을 가짐
- 약관 동의 화면 표시 여부는 **콘솔 설정**에 의존

### 3. 분류 결과

**결론: B. 콘솔 설정 문제** ✅

**근거:**
1. 코드는 SDK 권장사항을 정확히 따름
2. appLogin() 호출이 올바름
3. 파라미터 설정이 정상
4. 약관 동의 화면 표시는 SDK 내부 로직 + 콘솔 설정에 의존

### 4. 필요한 조치

#### 코드 측면
- ✅ 현재 구현 정상 (수정 불필요)
- ✅ 디버그 로깅 충분

#### 콘솔 설정 확인 필요 (수동 조치)
1. **AppsInToss 콘솔** 접속
2. **약관 동의 설정** 확인
   - 약관 동의 화면 활성화 여부
   - 약관 내용 등록 여부
   - 약관 동의 필수 여부
3. **테스트 환경** 설정 확인
   - 샌드박스 환경에서 약관 설정 동기화 여부

### 5. 추가 검증 방법

**콘솔 설정 문제 확인:**
```
1. 토스 앱 > 개발자 센터 > 앱인토스 콘솔
2. 해당 미니앱 선택
3. 설정 > 약관 동의 섹션 확인
4. 약관 동의 화면 활성화 상태 확인
5. 테스트 환경에서 재배포 후 확인
```

**코드 검증:**
```bash
# 로그 확인
# 브라우저 개발자 도구 > Console
# "appLogin() 호출" 로그 확인
# "appLogin() 성공" 로그 확인
```

## 결론

✅ **코드는 정상입니다.**

약관 동의 화면이 표시되지 않는 것은:
- SDK 내부 로직이 아닌 **콘솔 설정 문제**일 가능성 높음
- appLogin() 함수는 약관 동의 화면 표시를 SDK에 위임
- 콘솔에서 약관 동의 설정이 활성화되어야 화면이 표시됨

**다음 단계:**
1. AppsInToss 콘솔에서 약관 동의 설정 확인
2. 필요시 약관 동의 화면 활성화
3. 테스트 환경에서 재배포 후 검증
